<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" href="main.css">
    <script src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script
            src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"
            integrity="sha256-T0Vest3yCU7pafRw9r+settMBX6JkKN06dqBnpQ8d30="
            crossorigin="anonymous"></script>

    <script>
        $(function () {
            $('main').effect('bounce', 500)
        });
    </script>
    <script>
        $(function () {
            $('.dyingCreature').toggle('explode', 500, callback)
            function callback() {
                setTimeout(function () {
                    $(".dyingCreature").removeAttr("style").hide().fadeIn();
                }, 1000);
            };
        });
    </script>
</head>
<body onload="start()">
<div id="main-container">
    <main>
        <section id="fight-section">
            <div id="opponent-cards">
                <div id="opponent-hero-frame">
                    <div id="opponent-hero-container" class="hero">
                        <div class="rating-stars-container">
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                        </div>
                        <h1 class="fight-card-name">Robo</h1>
                        <img class="fight-card " src="imgs/robot-hero1.jpg">
                        <div class="card-state-container">
                            <div class="card-stats-container">
                                <span class="opponent-hero-energy">3</span>
                                <span class="opponent-hero-health">7</span>
                            </div>
                        </div>
                    </div>
                </div>
                <h1 class="opponent-cards-left">10 cards left</h1>
                <div id="opponent-card-back-container">
                    <img class="opponent-card-back" src="imgs/card-back.jpg">
                </div>
            </div>
            <div id="player-cards">
                <div id="player-hero-frame">
                    <div id="player-hero-container" class="hero">
                        <div class="rating-stars-container">
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                            <img class="rating-star-img" src="imgs/full-star.png"/>
                        </div>
                        <h1 class="fight-card-name">Jason</h1>
                        <img class="fight-card " src="imgs/robot-hero1.jpg">
                        <div class="card-state-container">
                            <div class="card-stats-container">
                                <span class="player-hero-energy">3</span>
                                <span class="player-hero-health">22</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="fight-card6-container" class="fight-cards" style="opacity: 0.3">
                    <div class="rating-stars-container">
                        <img class="rating-star-img" src="imgs/full-star.png"/>
                        <img class="rating-star-img" src="imgs/full-star.png"/>
                        <img class="rating-star-img" src="imgs/full-star.png"/>
                        <img class="rating-star-img" src="imgs/full-star.png"/>
                        <img class="rating-star-img" src="imgs/full-star.png"/>
                    </div>
                    <h1 class="fight-card-name">Crocodile</h1>
                    <img class="fight-card " src="imgs/eagle.jpg">
                    <div class="card-state-container">
                        <div class="card-stats-container">
                            <span class="attack">2</span>
                            <span class="health">7</span>
                        </div>
                    </div>
                </div>
                <h1 class="player-cards-left">10 cards left</h1>
                <div id="player-card-back2-container">
                    <img class="player-card-back" src="imgs/card-back.jpg">
                </div>
            </div>
            <button id="endTurn" onclick="opponentCardMovingToPosition()">End Turn</button>
            <img id="clock" onclick="opponentCardMovingToPosition()"
                 src="imgs/clock.gif">
            <div id="damage1">-3</div>
            <div id="damage2">-3</div>
            <div id="damage3">-3</div>
            <div id="damage4">-3</div>
            <div id="damage5">-3</div>
            <div id="damage6">-3</div>
            <div id="damage7">-3</div>
            <div id="damage8">-3</div>
        </section>
    </main>
    <img id="fire-down" src="imgs/fire2.gif"/></section>
    <img id="fire-up" src="imgs/fire2.gif"/></section>
    <img id="fire-left" src="imgs/fire2.gif"/></section>
    <img id="fire-right" src="imgs/fire2.gif"/></section>
</div>

<script>
    'use strict';
    let playerActsFirst = true;
    let playerCardsOnTable = 0;
    let playerCardsInPlay = 0;////////////////////////////////////////////////////cards ready to get into play
    let playerCardsPositions = [false, false, false]
    let playerFightCards = []/////////////////////////////////////////////arr with all player's creatures
    let playerDeck = []///////////////////////////////////////////////////arr with all player's creatures stats
    let playerCardsInAction = []
    let isCardPlayed = false;

    let opponentCardsOnTable = 0;
    let opponentCardsInPlay = 0
    //    let opponentCardsPositions = [false, false, false]
    let opponentFightCards = []
    let opponentDeck = []
    let opponentCardsInAction = []


    function start() {
        fillPlayerDeckForFight(function done() {
            newPlayerCardIntoCreature(function done() {
                setTimeout(function () {

                    newDeal()


                }, 500)

            })
        });
        fillOpponentDeckForFight(function done() {
            newOpponentCardIntoCreature()
        });


        $('.deck-card').click(function () {

//            console.log($('#deck-card2-container').position().top);

//            console.log(event.target.parentElement.id)
        });
    }

    $("#clock,#endTurn").click(function () {
        $("#clock,#endTurn").animate({
            left: "+=5px"
        }, 100).animate({
            left: "-=5px"
        }, 200)

//        $("#clock,#endTurn").css("left", "492px");


    });

    function fillPlayerDeckForFight(done) {
        for (let i = 0; i < 10; i++) {
            let current = {
                level: 4,
                name: 'Snake',
                src: "imgs/snake.jpg",
                attack: 4,
                health: 8
            }
            playerDeck.push(current)
            if (i === 9) {
                done()
            }
        }
    }

    function fillOpponentDeckForFight(done) {
        for (let i = 0; i < 10; i++) {
            let current = {
                level: 2,
                name: 'Eagle',
                src: "imgs/eagle.jpg",
                attack: 2,
                health: 5
            }
            opponentDeck.push(current)
            if (i === 9) {
                done()
            }
        }
    }

    function newDeal() {
        let position = playerCardsPositions.findIndex(element => element === false)
        console.log(position)
        playerCardsPositions[position] = true

        position++


        if (position > 0 && playerCardsOnTable !== 10) {
            console.log('fuuucking true')
            setTimeout(function () {
                playerCardsOnTable++
                movingToHand('position' + position)

            }, 500)

        }
        else {
            console.log(isCardPlayed);
            if (playerCardsInPlay < 3 && isCardPlayed === false) {
                setTimeout(function () {
                    $('.fight-cards').addClass('clickable')

                }, 0)
//

            }

        }
        if (playerCardsInPlay === 3) {
            setTimeout(function () {
                $('#endTurn,#clock').css('pointer-events', 'auto')
            }, 1900)

        }
//        newPlayerCardIntoCreature('position1', function drawSecondCard() {
//            newPlayerCardIntoCreature('position2', function drawThirdCard() {
//                newPlayerCardIntoCreature('position3', function hideBoxShadow() {
//                    $('#player-card-back2-container').css('display', 'none')
//                })
//            })
//        });

//        console.log('newdeal')
    }

    function newPlayerCardIntoCreature(done) {
        for (let i = 0; i < 10; i++) {
            let current = playerDeck[i]
//            console.log(playerDeck[i])
            let creatureName = current.name
            let playerCards = $('#player-cards')
            let creature = $("<div>").addClass("fight-cards")
            let rating = $("<div>").addClass("rating-stars-container").addClass("hideWhenFaceOff")
            for (var j = 0; j < playerDeck[i].level; j++) {
                let star = $("<img>").attr("src", "imgs/full-star.png").addClass("rating-star-img").appendTo(rating)
            }
            rating.appendTo(creature)
            let name = $("<h1>").addClass("fight-card-name").addClass("hideWhenFaceOff").html(playerDeck[i].name).appendTo(creature)
            let src = '' + (playerDeck[i].src)
            let pic = $("<img>").attr("src", src).addClass("fight-card").appendTo(creature)
            let state = $("<div>").addClass("card-state-container").addClass("hideWhenFaceOff").appendTo(creature);
            let stats = $("<div>").addClass("card-stats-container").appendTo(state);
            let attack = $("<span>").addClass("attack").html(playerDeck[i].attack).appendTo(stats)
            let health = $("<span>").addClass("health").html(playerDeck[i].health).appendTo(stats)
            let stain = $("<img>").attr("src", 'imgs/blood-stain1.gif').addClass("blood-stain1").addClass("hideWhenFaceOff").appendTo(creature)
            creature.appendTo(playerCards)
            playerFightCards.push(creature)
            if (i === 9) {
                done()
            }
        }
    }

    function newOpponentCardIntoCreature() {
        for (let i = 0; i < 10; i++) {
            let current = opponentDeck[i]
//            console.log(playerDeck[i])
            let creatureName = current.name
            let playerCards = $('#opponent-cards')
            let creature = $("<div>").addClass("fight-cards")
            let rating = $("<div>").addClass("rating-stars-container").addClass("hideWhenFaceOff")
            for (var j = 0; j < opponentDeck[i].level; j++) {
                let star = $("<img>").attr("src", "imgs/full-star.png").addClass("rating-star-img").appendTo(rating)
            }
            rating.appendTo(creature)
            let name = $("<h1>").addClass("fight-card-name").addClass("hideWhenFaceOff").html(opponentDeck[i].name).appendTo(creature)
            let src = '' + (opponentDeck[i].src)
            let pic = $("<img>").attr("src", src).addClass("fight-card").appendTo(creature)
            let state = $("<div>").addClass("card-state-container").addClass("hideWhenFaceOff").appendTo(creature);
            let stats = $("<div>").addClass("card-stats-container").appendTo(state);
            let attack = $("<span>").addClass("attack").html(opponentDeck[i].attack).appendTo(stats)
            let health = $("<span>").addClass("health").html(opponentDeck[i].health).appendTo(stats)
            let stain = $("<img>").attr("src", "imgs/blood-stain1.gif").addClass("blood-stain1").addClass("hideWhenFaceOff").appendTo(creature)
            creature.appendTo(playerCards)
            opponentFightCards.push(creature)
//            if (i === 9) {
//                done()
//            }
        }
    }

    function movingToHand(position) {
        $('.fight-cards').removeClass('clickable')
//        $('#fight-section').css('pointer-events', 'none')
//        console.log(position)
//        console.log('moving')
        let current = playerCardsOnTable
        let src = '' + $(playerFightCards[current]).find('.fight-card').attr("src")
//        console.log(''+src)
//        console.log(position)
        if (position === 'position1') {

            $(playerFightCards[current]).css('display', 'block').addClass('toPosition1');
        }
        else if (position === 'position2') {
            $(playerFightCards[current]).addClass('toPosition2').css('display', 'block');
        }
        else if (position === 'position3') {
            $(playerFightCards[current]).addClass('toPosition3').css('display', 'block');
        }
        else {
//            $('#fight-section').css('pointer-events', 'auto')
            return;
        }


        $(playerFightCards[current]).find('.hideWhenFaceOff').css('display', 'none');
        setTimeout(function () {
            $(playerFightCards[current]).find('.hideWhenFaceOff').css('display', 'none');
            $(playerFightCards[current]).find('.fight-card').attr("src", "imgs/card-back.jpg")
        }, 0);

        setTimeout(function () {
            $(playerFightCards[current]).find('.hideWhenFaceOff').css('display', 'block');
            $(playerFightCards[current]).find('.fight-card').attr("src", src)
        }, 170);

        setTimeout(function () {
//           $('#fight-section').css('pointer-events', 'auto')
        }, 1400);

        setTimeout(function () {
//            $(playerFightCards[current]).find('.hideWhenFaceOff').css('display', 'block');
//            $(playerFightCards[current]).find('.fight-card').attr("src", src)

        }, 3250);

        $('.player-cards-left').text(10 - playerCardsOnTable + ' cards left')

        setTimeout(function () {
//            let playerCardBack = $('#player-card-back-container');
//            let lastClass = playerFightCards[current].attr('class').split(' ').pop();
//            $(playerFightCards[current]).addClass('whenHovered')
//            playerFightCards[current].removeClass(lastClass).css('display', 'block');
//            if (playerCardsInPlay === 3) {
//                $('#endTurn,#clock').css('pointer-events', 'auto')
//            }

//                $('.fight-cards').addClass('clickable')


            $(playerFightCards[current]).click(function () {
                $('#endTurn,#clock').css('pointer-events', 'auto')
//                this.style.webkitAnimationPlayState = "paused";
                if ($(this).hasClass('clickable')) {
//                    console.log('oi');
                    playerCardsInAction.push(playerFightCards[current])
                    playerCardsInPlay++
//                    if(playerCardsInPlay!==3){
                    playerCardsPositions[position.substring(8, 9) - 1] = false
//                    }

//                    $(playerFightCards[current]).css('top', '-0px');
                    $(playerFightCards[current]).find('.blood-stain1').trigger('mouseout');
                    movingToPosition(playerFightCards[current], position)
                    isCardPlayed = true;
//                    console.log('iscardplayed ==true')
                    $('.fight-cards').removeClass('clickable')
                }
            })


            $('.fight-cards').removeClass('clickable')
            newDeal()
            $(playerFightCards[current]).find('.blood-stain1').mouseenter(function () {
                $(playerFightCards[current]).animate({
                    'top': '-210'
                }, 300);
            }).mouseout(function () {
                $(playerFightCards[current]).animate({
                    'top': '-154'
                }, 0);
            });

//            if(playerCardsInPlay===3){
//                $('.fight-cards').addClass('clickable')
//            }

//            $('.hideWhenFaceOff').css('display', 'none');
//            $('#player-card-back-container .player-card-back').attr("src", "imgs/card-back.jpg");
//            playerCardBack.css('display', 'block');
//            drawSecondCard();
//            drawThirdCard();
//            hideBoxShadow();
        }, 1400)


    }

    function opponentCardMovingToPosition() {

        $('#endTurn,#clock').css('pointer-events', 'none')
        if (opponentCardsInPlay !== 3) {

            if (opponentCardsOnTable === 10)return;
//        console.log(playerCardsInPlay)
//        console.log('opponentCardsInPlay' + opponentCardsInPlay)
//        console.log('opponentCardsOnTable' + opponentCardsOnTable)
            let src = '' + $(opponentFightCards[0]).find('.fight-card').attr("src");
//        console.log(opponentCardsOnTable)

            let current = opponentCardsOnTable;
            opponentFightCards[current].find('.fight-card').attr('src', 'imgs/card-back.jpg');
            opponentFightCards[current].find('.hideWhenFaceOff').css('display', 'none');
            setTimeout(function () {
                opponentFightCards[current].find('.fight-card').attr('src', src);
                opponentFightCards[current].find('.hideWhenFaceOff').css('display', 'block')
            }, 170);
            if (opponentCardsInPlay === 0) {
//            console.log('works')
                opponentFightCards[opponentCardsOnTable].addClass('moveToOpponentHand1').css('display', 'block');
                opponentCardsInPlay++;
                opponentCardsOnTable++;
            }
            else if (opponentCardsInPlay === 1) {
                opponentFightCards[opponentCardsOnTable].addClass('moveToOpponentHand2').css('display', 'block');
                opponentCardsInPlay++;
                opponentCardsOnTable++
            }
            else if (opponentCardsInPlay === 2) {
                opponentFightCards[opponentCardsOnTable].addClass('moveToOpponentHand3').css('display', 'block');
                opponentCardsInPlay++;
                opponentCardsOnTable++
            }
            $('.opponent-cards-left').text(10 - opponentCardsOnTable + ' cards left');
            setTimeout(function () {
                isCardPlayed = false;///////////////////////////////////////////////////////////?????????????????
                roundAction()
            }, 1400)
//            setTimeout(function () {//////REPEAT FOR TESTING------------------------------------------------------------------
//                roundAction()
//            }, 2800)
            opponentCardsInAction.push(opponentFightCards[current])
        }
        else {
//            setTimeout(function () {
            roundAction()
//            }, 0)

        }

    }

    function movingToPosition(e, position) {
//        console.log(playerCardsInPlay)
//        console.dir(position)
        if (playerCardsInPlay === 1) {
            if (position === 'position1') {
                $(e).addClass('moveToHand1to1').css('pointer-events', 'none');
            }
            else if (position === 'position2') {
                $(e).addClass('moveToHand2to1').css('pointer-events', 'none');
            }
            else if (position === 'position3') {
                $(e).addClass('moveToHand3to1').css('pointer-events', 'none');
            }

        }
        else if (playerCardsInPlay === 2) {
            if (position === 'position1') {
                $(e).addClass('moveToHand1to2').css('pointer-events', 'none');
            }
            else if (position === 'position2') {
                $(e).addClass('moveToHand2to2').css('pointer-events', 'none');
            }
            else if (position === 'position3') {
                $(e).addClass('moveToHand3to2').css('pointer-events', 'none');
            }


        }
        else if (playerCardsInPlay === 3) {
            if (position === 'position1') {
                $(e).addClass('moveToHand1to3').css('pointer-events', 'none');
            }
            else if (position === 'position2') {
                $(e).addClass('moveToHand2to3').css('pointer-events', 'none');
            }
            else if (position === 'position3') {
                $(e).addClass('moveToHand3to3').css('pointer-events', 'none');
            }
        }

        setTimeout(function () {
//            alert()
//            alert()
//            let card = $(e.parentElement);
//            let lastClass = card.attr('class').split(' ').pop();
//            card.removeClass(lastClass);
        }, 1400);


//        $(e.parentElement).children('.deck-card-state-container').children('.deck-card-stats-container').hide()
//        $(e.parentElement).children('.deck-card-state-container').children('.deck-card-stats-container').children('.deck-card-health').css({
//            'position': 'relative',
//            'padding-bottom': '2px',
//            'right': '-58px',
//            'bottom': '35px',
//            'display': 'block',
//            'background-size': '40px 30px',
//            'font-size': 21,
//        });
//
//        $(e.parentElement).children('.deck-card-state-container').children('.deck-card-stats-container').children('.deck-card-attack').css({
//            'background': 'url(imgs/attack.png)',
//            "background-size": "35px 28px",
//            'background-position': 'center',
//            'background-repeat': 'no-repeat',
//            'font-size': 21,
//            'margin-left': '10px',
//            'left': '-61px',
//            'top': '-6px'
//        });
//
//        setTimeout(function () {
//            $(e.parentElement).children('.deck-card-state-container').children('.deck-card-stats-container').css({
//                'top': '130px'
//            }).show()
//        }, 1700);
//
//        setTimeout(function () {
//            $(e.parentElement).children('h1').show()
//        }, 1500);
//
//        $(e.parentElement).children('.deck-rating-stars-container').children('.deck-rating-star-img').css(
//                'width', 0 + 'px',
//                'height', 0 + 'px'
//        );
//
//        $(e.parentElement)
//                .css('pointer-events', 'none')
//                //                .addClass('toPosition4')
//                .animate({
//                    'width': 152,
//                    'height': 200,
//                    'top': top,
//                    'left': left
//                }, 333);
//
//        $(e.parentElement).children('.deck-rating-stars-container').animate({
//            'position': 'relative',
//            'top': -2 + 'px',
//            'min-height': 25 + 'px'
//        }, 1000);
//
//        $(e).css(
//                'border', '2px dashed',
//                'box-shadow', '0px 0px 10px #ffffec'
//        );
//
//        setTimeout(function () {
//            $(e.parentElement).children('.deck-rating-stars-container').children('.deck-rating-star-img').animate({
//                'width': 15 + 'px',
//                'height': 15 + 'px'
//            }, 1000);
//        }, 800);
//
//        $(e.parentElement).children('h1').hide().css({
//            'font-size': 18 + 'px',
//            'position': 'relative',
//            'top': -16,
//        });
//
//        $(e).animate({
//            'width': 152,
//            'height': 200
//        }, 1000)
    }
    //    .replaceWith($(card1).clone())-----------------------------clone element


    function roundAction() {
//        console.log(playerCardsInAction[0].find($('.attack')).text())
//        console.log(playerCardsInPlay);

        let playerCardInAction1 = playerCardsInAction[0]
        let playerCardInAction2 = playerCardsInAction[1]
        let playerCardInAction3 = playerCardsInAction[2]

        let opponentCardInAction1 = opponentCardsInAction[0]
        let opponentCardInAction2 = opponentCardsInAction[1]
        let opponentCardInAction3 = opponentCardsInAction[2]

        if (playerActsFirst === true) {
            playerTurn(function finished() {
                setTimeout(function () {
                    opponentTurn(function finished() {
                        newDeal()
                    })
                }, 500)
            })
        }
        else {
            opponentTurn(function finished() {
                setTimeout(function () {
                    playerTurn(function finished() {
                        newDeal()
                    })
                }, 500)
            })
        }

        function opponentTurn(finished) {
            checkOpponentCard1(function done() {
                checkOpponentCard2(function done() {
                    checkOpponentCard3(function done() {
                        finished()
                    })
                })
            })

            function checkOpponentCard1(done) {
                if (opponentCardInAction1) {
                    let amountOfDamage = opponentCardInAction1.find('.attack').html()
                    if (playerCardInAction1) {
                        opponentCardHitsPlayerCard(opponentCardInAction1, 1, '318px')
                        playerCardTakesHit(playerCardInAction1, amountOfDamage)
                        displayDamage(6, amountOfDamage)
                    }
                    else {
                        opponentCardHitsPlayerHero(opponentCardInAction1, 1)
                        playerCardTakesHit($('#player-hero-frame'))
                        playerHeroTakesHit(amountOfDamage)
                        displayDamage(5, amountOfDamage)
                    }

                    setTimeout(function () {
                        done()
                    }, 520)
                }
                else {
                    done()
                }
            }

            function checkOpponentCard2(done) {
                if (opponentCardInAction2) {
                    let amountOfDamage = opponentCardInAction2.find('.attack').html()
                    if (playerCardInAction2) {
                        opponentCardHitsPlayerCard(opponentCardInAction2, 2, '478px')
                        playerCardTakesHit(playerCardInAction2, amountOfDamage)
                        displayDamage(7, amountOfDamage)
                    }
                    else {
                        opponentCardHitsPlayerHero(opponentCardInAction2, 2)
                        playerCardTakesHit($('#player-hero-frame'))
                        playerHeroTakesHit(amountOfDamage)
                        displayDamage(5, amountOfDamage)
                    }

                    setTimeout(function () {
                        done()
                    }, 520)
                }
                else {
                    done()
                }
            }

            function checkOpponentCard3(done) {
                if (opponentCardInAction3) {
                    let amountOfDamage = opponentCardInAction3.find('.attack').html()
                    if (playerCardInAction3) {
                        opponentCardHitsPlayerCard(opponentCardInAction3, 3, '638px')
                        playerCardTakesHit(playerCardInAction3, amountOfDamage)
                        displayDamage(8, amountOfDamage)
                    }
                    else {
                        opponentCardHitsPlayerHero(opponentCardInAction3, 3)
                        playerCardTakesHit($('#player-hero-frame'))
                        playerHeroTakesHit(amountOfDamage)
                        displayDamage(5, amountOfDamage)
                    }

                    setTimeout(function () {
//                    newDeal()
                        done()
                    }, 520)
                }
                else {
                    done()
                }
            }
        }

        function playerTurn(finished) {
            checkPlayerCard1(function done() {
                checkPlayerCard2(function done() {
                    checkPlayerCard3(function done() {
                        finished()
                    })
                })
            })


            function checkPlayerCard1(done) {
                if (playerCardInAction1) {
                    let amountOfDamage = playerCardInAction1.find('.attack').html()
                    if (opponentCardInAction1) {
                        playerCardHitsOpponentCard(playerCardInAction1, 1, '318px')
                        opponentCardTakesHit(opponentCardInAction1, amountOfDamage)
                        displayDamage(2, amountOfDamage)
                    }
                    else {
                        playerCardHitsOpponentHero(playerCardInAction1, 1)
                        opponentCardTakesHit($('#opponent-hero-frame'), amountOfDamage)
                        opponentHeroTakesHit(amountOfDamage)
                        displayDamage(1, amountOfDamage)
                    }
                    setTimeout(function () {
                        done()
                    }, 520)
                }
                else {
                    done()
                }

            }

            function checkPlayerCard2(done) {
                if (playerCardInAction2) {
                    let amountOfDamage = playerCardInAction2.find('.attack').html()
                    if (opponentCardInAction2) {
                        playerCardHitsOpponentCard(playerCardInAction2, 2, '478px')
                        opponentCardTakesHit(opponentCardInAction2, amountOfDamage)
                        displayDamage(3, amountOfDamage)
                    }
                    else {
                        playerCardHitsOpponentHero(playerCardInAction2, 2)
                        opponentCardTakesHit($('#opponent-hero-frame'))
                        opponentHeroTakesHit(amountOfDamage)
                        displayDamage(1, amountOfDamage)
                    }
                    setTimeout(function () {
                        done()
                    }, 520)
                }
                else {
                    done()
                }
            }

            function checkPlayerCard3(done) {
                if (playerCardInAction3) {
                    let amountOfDamage = playerCardInAction3.find('.attack').html()
                    if (opponentCardInAction3) {
                        playerCardHitsOpponentCard(playerCardInAction3, 3, '638px')
                        opponentCardTakesHit(opponentCardInAction3, amountOfDamage)
                        displayDamage(4, amountOfDamage)
                    }
                    else {
                        playerCardHitsOpponentHero(playerCardInAction3, 3)
                        opponentCardTakesHit($('#opponent-hero-frame'))
                        opponentHeroTakesHit(amountOfDamage)
                        displayDamage(1, amountOfDamage)
                    }

                    setTimeout(function () {
                        done()
                    }, 520)
                }
                else {
                    done()
                }

            }
        }
    }


    function opponentCardTakesHit(current, amountOfDamage) {
//        dyingCreature(current)
        let currentCreatureHealth = current.find('.health').text()
        setTimeout(function () {
            current.animate({
                top: '-=30'
            }, 110, function () {
                $(this).animate({
                    opacity: 1
                }, 150, function () {
                    $(this).animate({
                        top: '+=30'
                    }, 100)
                })
            })
                    .find('.health').text(currentCreatureHealth - amountOfDamage)
            current.find('.blood-stain1')
                    .animate({
                        'opacity': '1'
                    }, 0, function () {
                        $(this).animate({
                            'opacity': '1'
                        }, 900, function () {
                            $(this).animate({
                                'opacity': '0.01'
                            }, 900)
                        })
                    })
        }, 130)
    }

    function playerCardTakesHit(current, amountOfDamage) {
//        console.log('takes hit')
        let currentCreatureHealth = current.find('.health').text()
        setTimeout(function () {
            current.animate({
                top: '+=30'
            }, 110, function () {
                $(this).animate({
                    opacity: 1
                }, 150, function () {
                    $(this).animate({
                        top: '-=30'
                    }, 100)
                })
            })
                    .find('.health').text(currentCreatureHealth - amountOfDamage)
            current.find('.blood-stain1')
                    .animate({
                        'opacity': '1'
                    }, 0, function () {
                        $(this).animate({
                            'opacity': '1'
                        }, 900, function () {
                            $(this).animate({
                                'opacity': '0.01'
                            }, 900)
                        })
                    })
        }, 130)
    }

    function opponentHeroTakesHit(amountOfDamage) {
        let current = $('#opponent-hero-container')
        let health = current.find('.opponent-hero-health').text()
        setTimeout(function () {
            current.find('.opponent-hero-health').text(health - amountOfDamage)
        }, 200)
    }

    function playerHeroTakesHit(amountOfDamage) {
        let current = $('#player-hero-container')
        let health = current.find('.player-hero-health').text()
        setTimeout(function () {
            current.find('.player-hero-health').text(health - amountOfDamage)
        }, 200)
    }

    function playerCardHitsOpponentCard(current, position, perspectiveOrigin) {
//        console.log(perspectiveOrigin)
//        console.log()
        $('#player-cards').css('perspective-origin', perspectiveOrigin).addClass('perspective');
        current.removeClass('playerCardLockedToPosition' + position);
        current.addClass('attackEnemyFromPosition' + position).animate({'nothing': null}, 500, function () {
            $(this).removeClass('attackEnemyFromPosition' + position);
            $('#player-cards').css('perspective-origin', '0px').removeClass('perspective');
//            console.log('0000000000000000px')
            $(this).addClass('playerCardLockedToPosition' + position);
        });
    }

    function opponentCardHitsPlayerCard(current, position, perspectiveOrigin) {
        $('#opponent-cards').css('perspective-origin', perspectiveOrigin).addClass('perspective');
        current.removeClass('opponentCardLockedToPosition' + position);
        current.addClass('attackPlayerFromPosition' + position).animate({'nothing': null}, 500, function () {
            $(this).removeClass('attackPlayerFromPosition' + position);
            $('#opponent-cards').css('perspective-origin', '0px').removeClass('perspective');
            $(this).addClass('opponentCardLockedToPosition' + position);
        });
    }

    function playerCardHitsOpponentHero(current, position) {
        $('#player-cards').css('perspective-origin', '120px').addClass('perspective');
        current.removeClass('playerCardLockedToPosition' + position);
        current.addClass('attackEnemyHeroFromPosition' + position).animate({'nothing': null}, 500, function () {
            $(this).removeClass('attackEnemyHeroFromPosition' + position);
            $('#player-cards').css('perspective-origin', '0px').removeClass('perspective');
            $(this).addClass('playerCardLockedToPosition' + position);
        });
    }

    function opponentCardHitsPlayerHero(current, position) {
        $('#opponent-cards').css('perspective-origin', '100px').addClass('perspective');
        current.removeClass('opponentCardLockedToPosition' + position);
        current.addClass('attackPlayerHeroFromPosition' + position).animate({'nothing': null}, 500, function () {
            $(this).removeClass('attackPlayerHeroFromPosition' + position);
            $('#opponent-cards').css('perspective-origin', '0px').removeClass('perspective');
            $(this).addClass('opponentCardLockedToPosition' + position);
        });
    }

    function displayDamage(n, amountOfDamage) {
        let current = $('#damage' + n)
        current.text('-' + amountOfDamage)

        setTimeout(function () {
            current.addClass('damage').css('display', 'block')
        }, 280)

        setTimeout(function () {
            current.removeClass('damage')
            current.css({
                'display': 'none'
            })
        }, 2000)
    }

    function dyingCreature(current) {


    }

</script>

</body>
</html>